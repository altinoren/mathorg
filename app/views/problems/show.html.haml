%h3
  = best_in_place_if user_signed_in?, @problem, :description, as: :input, display_as: :description_maybe_empty

= render 'sources', problem: @problem
%br/

%strong
  Id: 
= @problem.id

= render 'topicables/topic_list', topicable: @problem
- if @problem.is_original? && @problem.duplicates.size > 0
  %strong Duplicate problem(s): 
  = raw(@problem.duplicates.map do |p|
    - link_to p.description, p
  - end.join(', '))
- if @problem.is_duplicate?
  %br/
  %em
    This problem is a duplicate. The original can be found 
    = link_to 'here.', @problem.original

%br/
- if not @problem.author.nil? and @problem.author != ''
  %strong Author:
  = @problem.author
  %br/
%br/
= raw(RichText.new(text: @problem.body).to_html)

%br/
%br/

- if user_signed_in?
  .btn-group
    = link_to 'Edit', edit_problem_path(@problem), { class: "btn btn-default" }
    = link_to 'Destroy', problem_path(@problem), { class: "btn btn-default", method: :delete, data: { confirm: 'Are you sure?' } }
  %br/
  %br/
  = render 'markings', { problem: @problem }
  
  %br/
  %a{class: "merge_button", href:"javascript:;"} Repeated problem?
  = render 'merge'

  = render 'votables/votes'  , { votable: @problem, scope: 'quality', disp_text: 'Writeup quality' }
  = render 'votables/ratings', { votable: @problem, scope: 'elegance', lower: -2, upper: 2 }
  = render 'votables/ratings', { votable: @problem, scope: 'instructiveness', lower: 0, upper: 2 }
  = render 'votables/ratings', { votable: @problem, scope: 'difficulty', lower: -2, upper: 2, show_average: false }
%br/
%br/

%h3 Solutions

- if @problem.solutions.size > 0
  .row.list-group 
    - @problem.solutions.sort_by(&:id).each do |solution| ##::TODO_LATER:: find a better problem sort. 
      .list-group-item
        = render 'solution', solution: solution
- else
  %em No solutions have been contributed yet for this problem.
  %br/
  %br/

- if user_signed_in?
  = link_to 'Add solution', new_problem_solution_path(@problem), { class: "btn btn-default" }